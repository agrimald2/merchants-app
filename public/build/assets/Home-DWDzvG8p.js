import{_ as f}from"./AdminLayout-Bdfyu58J.js";import{o as i,c as n,w as d,i as l,a as t,t as a,e as c,h,F as g,f as p}from"./app-B04sb2MP.js";import m from"./PendingVisitsComponent-CiOMBFyZ.js";import _ from"./DoneVisitsComponent-MMg_OKHl.js";import u from"./ScanQR-85Offosg.js";import"./ResponsiveNavLink-BuWZS_x3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VisitDetailsModal-DQ8n4uXu.js";const V={class:"font-semibold text-lg text-white leading-tight text-center"},v={class:"max-w-2xl mx-auto"},x={class:"bg-white p-4"},b={class:"filters"},w={class:"grid grid-cols-3 gap-4 mb-4"},y={class:"shadow-md bg-gray-50 text-black rounded-lg p-4 flex flex-col items-center"},P=t("i",{class:"text-xl fa-solid fa-bullseye"},null,-1),k=t("div",{class:"text-sm"},"Objetivo",-1),O={class:"text-2xl font-bold"},D={class:"shadow-md bg-gray-50 text-black rounded-lg p-4 flex flex-col items-center"},M=t("i",{class:"text-xl fa-regular fa-circle-check text-green-500"},null,-1),Q=t("div",{class:"text-sm"},"Realizadas",-1),C={class:"text-2xl font-bold"},E={class:"shadow-md bg-gray-50 text-black rounded-lg p-4 flex flex-col items-center"},R=t("i",{class:"text-xl fa-solid fa-stopwatch text-yellow-500"},null,-1),S=t("div",{class:"text-sm"},"Pendientes",-1),L={class:"text-2xl font-bold"},q={class:"px-3 pt-6"},I=t("p",null,"Visitas Pendientes",-1),B={class:"px-3 pt-6"},N=t("p",null,"Visitas Realizadas",-1),j=t("i",{class:"fa-solid fa-qrcode"},null,-1),z=[j],F={components:{DoneVisitsComponent:_,PendingVisitsComponent:m,ScanQR:u},data(){return{isQRModalVisible:!1,pendingVisits:[],doneVisits:[],isOnVisit:null}},computed:{totalVisits(){return this.pendingVisits.length+this.doneVisits.length}},created(){this.fetchPendingVisits(),this.fetchDoneVisits(),this.fetchIsOnVisit()},methods:{toggleQrModal(){this.isQRModalVisible=!this.isQRModalVisible},async fetchPendingVisits(){try{const s=await l.get(route("merchant.pendingVisits"));this.pendingVisits=s.data}catch(s){console.error("Error fetching pending visits:",s)}},async fetchDoneVisits(){try{const s=await l.get(route("merchant.doneVisits"));this.doneVisits=s.data}catch(s){console.error("Error fetching done visits:",s)}},async fetchIsOnVisit(){try{const s=await l.post(route("merchant.isOnVisit"));this.isOnVisit=s.data.visit,console.log(s.data),s.data.isOnVisit&&(window.location.href=route("merchant.view.visit",{id:this.isOnVisit.id}))}catch(s){console.error("Error fetching is on visit:",s)}},requestLocationPermission(){navigator.geolocation?navigator.geolocation.getCurrentPosition(()=>{this.toggleQrModal()},s=>{s.code===s.PERMISSION_DENIED&&alert("Location permission is required to start a visit. Please enable location services.")}):alert("Geolocation is not supported by this browser. Please ensure location services are enabled in your device settings.")}}},W=Object.assign(F,{__name:"Home",setup(s){return(e,r)=>(i(),n(f,{title:"Dashboard"},{header:d(()=>[t("h2",V,a(new Date().toLocaleDateString("es-ES",{weekday:"long",month:"long",day:"numeric"})),1)]),default:d(()=>[t("div",v,[t("div",x,[t("div",b,[t("div",w,[t("div",y,[P,k,t("div",O,a(e.totalVisits),1)]),t("div",D,[M,Q,t("div",C,a(e.doneVisits.length),1)]),t("div",E,[R,S,t("div",L,a(e.pendingVisits.length),1)])])])]),t("div",q,[I,(i(!0),c(g,null,h(e.pendingVisits,o=>(i(),n(m,{visit:o,onScan:e.toggleQrModal},null,8,["visit","onScan"]))),256))]),t("div",B,[N,(i(!0),c(g,null,h(e.doneVisits,o=>(i(),n(_,{visit:o},null,8,["visit"]))),256))]),t("button",{onClick:r[0]||(r[0]=(...o)=>e.requestLocationPermission&&e.requestLocationPermission(...o)),class:"fixed bottom-4 right-4 bg-red-500 text-white p-4 rounded-full shadow-lg flex items-center justify-center"},z)]),e.isQRModalVisible?(i(),n(u,{key:0,onClose:e.toggleQrModal},null,8,["onClose"])):p("",!0)]),_:1}))}});export{W as default};
