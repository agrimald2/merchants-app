import{d as k,o as a,e as c,b as n,u as f,Z as P,a as e,w as o,A as S,g as l,t as r,m as p,n as C,f as g,r as v,D as M,c as h,i as u,h as b,F as x}from"./app-CxrSCD6l.js";import{_ as D,a as O,b as y,c as Q,d as m}from"./ResponsiveNavLink-BlnKUect.js";import w from"./PendingVisitsComponent-whlr_8cK.js";import $ from"./DoneVisitsComponent-DNSoccBx.js";import V from"./ScanQR-DUm4ldKS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VisitDetailsModal-B9cSccLy.js";const E={class:"min-h-screen bg-gray-100"},R={class:"bg-red-ac sticky top-0 z-50"},j={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},L={class:"flex justify-between h-16"},N={class:"flex items-center"},I={class:"shrink-0 flex items-center"},q=e("img",{src:"https://companieslogo.com/img/orig/AC.MX_BIG.D-d3508e09.png?t=1640335174",alt:"",class:"h-8 w-auto"},null,-1),B={class:"sm:flex items-center mx-4 text-white absolute left-1/2 transform -translate-x-1/2 font-bold"},z=e("i",{class:"fa-solid fa-face-laugh-wink"},null,-1),F={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},H={class:"hidden sm:flex sm:items-center sm:ms-6"},A={class:"ms-3 relative"},G={class:"inline-flex rounded-md"},T={type:"button",class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-gray-500 bg-white hover:text-gray-700 focus:outline-none focus:bg-gray-50 active:bg-gray-50 transition ease-in-out duration-150"},X=e("i",{class:"fa-solid fa-bars text-white"},null,-1),Z=e("div",{class:"block px-4 py-2 text-xs text-gray-400"}," Manage Account ",-1),J=e("div",{class:"border-t border-gray-200"},null,-1),K={class:"-me-2 flex items-center sm:hidden"},U=e("i",{class:"fa-solid fa-bars text-white"},null,-1),W=[U],Y={class:"pt-2 pb-3 space-y-1"},ee=e("span",{class:"font-bold"},"Home",-1),te={class:"pt-4 pb-1 border-t border-gray-200"},se={class:"flex items-center px-4"},ie={key:0,class:"shrink-0 me-3"},oe=["src","alt"],ne={class:"font-medium text-sm text-gray-500"},ae={class:"mt-3 space-y-1"},re={key:0,class:"bg-red-ac shadow rounded-b-3xl"},le={class:"max-w-7xl mx-auto pb-3 px-4 sm:px-6 lg:px-8 pt-2"},de={__name:"MerchantLayout",props:{title:String},setup(s){const i=k(!1),d=()=>{M.post(route("logout"))};return(t,_)=>(a(),c("div",null,[n(f(P),{title:s.title},null,8,["title"]),n(D),e("div",E,[e("nav",R,[e("div",j,[e("div",L,[e("div",N,[e("div",I,[n(f(S),{href:t.route("merchant.home")},{default:o(()=>[q]),_:1},8,["href"])]),e("div",B,[z,l(" ¡Hola "+r(t.$page.props.auth.user.name.substring(0,10))+"...! ",1)]),e("div",F,[n(O,{href:t.route("merchant.home"),active:t.route().current("merchant.home")},{default:o(()=>[l(" Home ")]),_:1},8,["href","active"])])]),e("div",H,[e("div",A,[n(Q,{align:"right",width:"48"},{trigger:o(()=>[e("span",G,[e("button",T,[l(r(t.$page.props.auth.user.name)+" ",1),X])])]),content:o(()=>[Z,n(y,{href:t.route("profile.show")},{default:o(()=>[l(" Perfil ")]),_:1},8,["href"]),J,e("form",{onSubmit:p(d,["prevent"])},[n(y,{as:"button"},{default:o(()=>[l(" Cerrar Sesión ")]),_:1})],32)]),_:1})])]),e("div",K,[e("button",{class:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out",onClick:_[0]||(_[0]=Le=>i.value=!i.value)},W)])])]),e("div",{class:C([{block:i.value,hidden:!i.value},"sm:hidden bg-white-ac"])},[e("div",Y,[n(m,{href:t.route("merchant.home"),active:t.route().current("merchant.home")},{default:o(()=>[ee]),_:1},8,["href","active"])]),e("div",te,[e("div",se,[t.$page.props.jetstream.managesProfilePhotos?(a(),c("div",ie,[e("img",{class:"h-10 w-10 rounded-full object-cover",src:t.$page.props.auth.user.profile_photo_url,alt:t.$page.props.auth.user.name},null,8,oe)])):g("",!0),e("div",null,[e("div",ne,r(t.$page.props.auth.user.username),1)])]),e("div",ae,[n(m,{href:t.route("profile.show"),active:t.route().current("profile.show")},{default:o(()=>[l(" Perfil ")]),_:1},8,["href","active"]),e("form",{method:"POST",onSubmit:p(d,["prevent"])},[n(m,{as:"button"},{default:o(()=>[l(" Cerrar Sesión ")]),_:1})],32)])])],2)]),t.$slots.header?(a(),c("header",re,[e("div",le,[v(t.$slots,"header")])])):g("",!0),e("main",null,[v(t.$slots,"default")])])]))}},ce={class:"font-semibold text-lg text-white leading-tight text-center mb-2"},he={class:"bg-gray-100 text-black p-1 text-center rounded"},ue={class:"font-semibold text-lg text-white leading-tight text-center"},me={class:"max-w-2xl mx-auto"},ge={class:"bg-white p-4"},_e={class:"filters"},fe={class:"grid grid-cols-3 gap-4 mb-4"},pe={class:"shadow-md bg-gray-50 text-black rounded-lg p-4 flex flex-col items-center"},ve=e("i",{class:"text-xl fa-solid fa-bullseye"},null,-1),be=e("div",{class:"text-sm"},"Objetivo",-1),xe={class:"text-2xl font-bold"},ye={class:"shadow-md bg-gray-50 text-black rounded-lg p-4 flex flex-col items-center"},we=e("i",{class:"text-xl fa-regular fa-circle-check text-green-500"},null,-1),$e=e("div",{class:"text-sm"},"Realizadas",-1),Ve={class:"text-2xl font-bold"},ke={class:"shadow-md bg-gray-50 text-black rounded-lg p-4 flex flex-col items-center"},Pe=e("i",{class:"text-xl fa-solid fa-stopwatch text-yellow-500"},null,-1),Se=e("div",{class:"text-sm"},"Pendientes",-1),Ce={class:"text-2xl font-bold"},Me={class:"px-3 pt-6"},De=e("p",null,"Visitas Pendientes",-1),Oe={class:"px-3 pt-6"},Qe=e("p",null,"Visitas Realizadas",-1),Ee=e("i",{class:"fa-solid fa-qrcode"},null,-1),Re=[Ee],je={components:{DoneVisitsComponent:$,PendingVisitsComponent:w,ScanQR:V},data(){return{isQRModalVisible:!1,pendingVisits:[],doneVisits:[],isOnVisit:null}},computed:{totalVisits(){return this.pendingVisits.length+this.doneVisits.length},averageProgress(){return this.totalVisits===0?0:(this.doneVisits.length/this.totalVisits*100).toFixed(0)}},created(){this.fetchPendingVisits(),this.fetchDoneVisits(),this.fetchIsOnVisit()},methods:{toggleQrModal(){this.isQRModalVisible=!this.isQRModalVisible},async fetchPendingVisits(){try{const s=await u.get(route("merchant.pendingVisits"));this.pendingVisits=s.data}catch(s){console.error("Error fetching pending visits:",s)}},async fetchDoneVisits(){try{const s=await u.get(route("merchant.doneVisits"));this.doneVisits=s.data}catch(s){console.error("Error fetching done visits:",s)}},async fetchIsOnVisit(){try{const s=await u.post(route("merchant.isOnVisit"));this.isOnVisit=s.data.visit,console.log(s.data),s.data.isOnVisit&&(window.location.href=route("merchant.view.visit",{id:this.isOnVisit.id}))}catch(s){console.error("Error fetching is on visit:",s)}},requestLocationPermission(){navigator.geolocation?navigator.geolocation.getCurrentPosition(()=>{this.toggleQrModal()},s=>{s.code===s.PERMISSION_DENIED&&alert("Location permission is required to start a visit. Please enable location services.")}):alert("Geolocation is not supported by this browser. Please ensure location services are enabled in your device settings.")}}},Ae=Object.assign(je,{__name:"Home",setup(s){return(i,d)=>(a(),h(de,{title:"Dashboard"},{header:o(()=>[e("h2",ce,[e("span",he,r(i.averageProgress)+"% ",1)]),e("h2",ue,r(new Date().toLocaleDateString("es-ES",{weekday:"long",month:"long",day:"numeric"})),1)]),default:o(()=>[e("div",me,[e("div",ge,[e("div",_e,[e("div",fe,[e("div",pe,[ve,be,e("div",xe,r(i.totalVisits),1)]),e("div",ye,[we,$e,e("div",Ve,r(i.doneVisits.length),1)]),e("div",ke,[Pe,Se,e("div",Ce,r(i.pendingVisits.length),1)])])])]),e("div",Me,[De,(a(!0),c(x,null,b(i.pendingVisits,t=>(a(),h(w,{visit:t,onScan:i.toggleQrModal},null,8,["visit","onScan"]))),256))]),e("div",Oe,[Qe,(a(!0),c(x,null,b(i.doneVisits,t=>(a(),h($,{visit:t},null,8,["visit"]))),256))]),e("button",{onClick:d[0]||(d[0]=(...t)=>i.requestLocationPermission&&i.requestLocationPermission(...t)),class:"fixed bottom-4 right-4 bg-red-500 text-white p-4 rounded-full shadow-lg flex items-center justify-center"},Re)]),i.isQRModalVisible?(a(),h(V,{key:0,onClose:i.toggleQrModal},null,8,["onClose"])):g("",!0)]),_:1}))}});export{Ae as default};
