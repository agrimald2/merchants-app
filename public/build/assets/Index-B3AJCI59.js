import{_ as M}from"./AdminLayout-Bdfyu58J.js";import k from"./AddMerchantModal-hUW1utvb.js";import C from"./MerchantDetailsModal-Dt04ldMc.js";import L from"./RemoveMerchantModal-CdWIaYuC.js";import{i as h,j as _,o as r,c as x,w as b,a as e,k as p,v as y,e as c,h as u,t as a,F as f,l as D,g as m,f as E}from"./app-B04sb2MP.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BuWZS_x3.js";const A={components:{AdminLayout:M,AddMerchantModal:k,MerchantDetailsModal:C,RemoveMerchantModal:L},data(){return{merchants:[],filteredMerchants:[],showAddModal:!1,showDetailsModal:!1,showRemoveModal:!1,newMerchant:{name:"",username:"",dni:"",phone:""},selectedMerchant:null,regions:[],locations:[],selectedRegion:"",selectedLocation:"",searchQuery:""}},mounted(){this.fetchMerchants(),this.getRegions(),this.getLocations()},methods:{goBack(){this.$inertia.get(route("admin.uploadData"))},fetchMerchants(){h.get("/admin/merchants/all").then(n=>{this.merchants=n.data,this.filterMerchants()}).catch(n=>{console.error("Error fetching merchants:",n)})},viewDetails(n){this.selectedMerchant=n,this.showDetailsModal=!0},async getRegions(){try{const n=await h.get("/api/regions");this.regions=n.data}catch(n){console.error("Error fetching regions:",n)}},async getLocations(){try{const n=await h.get("/api/locations");this.locations=n.data}catch(n){console.error("Error fetching locations:",n)}},filterMerchants(){this.filteredMerchants=this.merchants.filter(n=>{const s=this.selectedRegion?n.location.sub_region.region.id===this.selectedRegion:!0,d=this.selectedLocation?n.location.id===this.selectedLocation:!0,i=this.searchQuery?n.name.toLowerCase().includes(this.searchQuery.toLowerCase())||n.dni.includes(this.searchQuery):!0;return s&&d&&i})},triggerFileInput(){this.$refs.fileInput.click()},handleFileUpload(n){const s=n.target.files[0];if(s){const d=new FormData;d.append("file",s),h.post("/admin/merchants/upload",d,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{this.fetchMerchants(),alert("Archivo subido exitosamente")}).catch(i=>{console.error("Error uploading file:",i),alert("Error al subir el archivo")})}},exportToExcel(){const n=this.filteredMerchants.map(o=>({Name:o.name,DNI:o.dni,Phone:o.phone,Location:o.location.name}));let s="\uFEFF";s+=`Nombre,DNI,Celular,Locaci贸n
`,n.forEach(o=>{s+=`${o.Name},${o.DNI},${o.Phone},${o.Location}
`});const d=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),l=URL.createObjectURL(d);i.setAttribute("href",l),i.setAttribute("download","lista_mercaderistas.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}}},I={class:"flex items-center justify-between w-full"},F=e("i",{class:"fa-solid fa-circle-chevron-left"},null,-1),N=[F],B=e("h2",{class:"font-semibold text-lg text-white leading-tight mx-auto"}," Mercaderistas ",-1),T=e("div",{class:"w-8"},null,-1),U={class:"max-w-3xl mx-auto p-4"},Q={class:"bg-white p-4 mb-2"},V={class:"filters"},S={class:"grid grid-cols-2 gap-4 mb-4"},j=e("label",{for:"region",class:"block text-sm font-medium text-gray-700"},"Regi贸n",-1),P=e("option",{value:""},"Todos",-1),O=["value"],q=e("label",{for:"location",class:"block text-sm font-medium text-gray-700"},"Locaci贸n",-1),z=e("option",{value:""},"Todos",-1),G=["value"],H={class:"mb-4"},J=e("label",{for:"merchantSearch",class:"block text-sm font-medium text-gray-700"},"Buscar Mercaderista",-1),K={class:"grid grid-cols-2 sm:grid-cols-2 gap-4"},W=e("i",{class:"fa-solid fa-file-excel mr-2"},null,-1),X=e("i",{class:"fa-solid fa-file-excel mr-2"},null,-1),Y={class:"overflow-x-auto hidden lg:block"},Z={class:"min-w-full bg-white shadow-md rounded-lg overflow-hidden"},$=e("thead",{class:"bg-gray-200"},[e("tr",null,[e("th",{class:"py-3 px-4 text-left"},"Name"),e("th",{class:"py-3 px-4 text-left"},"DNI"),e("th",{class:"py-3 px-4 text-left"},"Celular"),e("th",{class:"py-3 px-4 text-left"},"Locaci贸n"),e("th",{class:"py-3 px-4 text-left"},"Actions")])],-1),ee={class:"py-3 px-4"},te={class:"py-3 px-4"},se={class:"py-3 px-4"},oe={class:"py-3 px-4"},ne={class:"py-3 px-4 flex space-x-2"},le=["onClick"],ie=e("i",{class:"fa-solid fa-circle-info"},null,-1),re=[ie],ae=["onClick"],ce=e("i",{class:"fa-solid fa-circle-minus"},null,-1),de=[ce],he={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 lg:hidden"},ue={class:"flex items-center justify-between"},fe={class:"text-lg font-semibold"},me={class:"flex space-x-2"},ge=["onClick"],pe=e("i",{class:"fa-solid fa-circle-info"},null,-1),_e=[pe],xe=["onClick"],be=e("i",{class:"fa-solid fa-circle-minus"},null,-1),ye=[be],ve={class:"text-sm text-gray-700"},we=e("strong",null,"Loc:",-1),Me=e("strong",null,"Phone:",-1);function ke(n,s,d,i,l,o){const v=_("AddMerchantModal"),w=_("AdminLayout");return r(),x(w,{title:"Mercaderistas"},{header:b(()=>[e("div",I,[e("button",{onClick:s[0]||(s[0]=(...t)=>o.goBack&&o.goBack(...t)),class:"text-white"},N),B,T])]),default:b(()=>[e("div",U,[e("div",Q,[e("div",V,[e("div",S,[e("div",null,[j,p(e("select",{id:"region","onUpdate:modelValue":s[1]||(s[1]=t=>l.selectedRegion=t),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:s[2]||(s[2]=(...t)=>o.filterMerchants&&o.filterMerchants(...t))},[P,(r(!0),c(f,null,u(l.regions,t=>(r(),c("option",{key:t.id,value:t.id},a(t.name),9,O))),128))],544),[[y,l.selectedRegion]])]),e("div",null,[q,p(e("select",{id:"location","onUpdate:modelValue":s[3]||(s[3]=t=>l.selectedLocation=t),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:s[4]||(s[4]=(...t)=>o.filterMerchants&&o.filterMerchants(...t))},[z,(r(!0),c(f,null,u(l.locations,t=>(r(),c("option",{key:t.id,value:t.id},a(t.name),9,G))),128))],544),[[y,l.selectedLocation]])])]),e("div",H,[J,p(e("input",{type:"text",id:"merchantSearch","onUpdate:modelValue":s[5]||(s[5]=t=>l.searchQuery=t),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",placeholder:"Buscar por nombre o DNI",onInput:s[6]||(s[6]=(...t)=>o.filterMerchants&&o.filterMerchants(...t))},null,544),[[D,l.searchQuery]])]),e("div",K,[e("div",null,[e("button",{class:"bg-blue-500 text-white px-5 py-1 rounded-md inline-flex items-center w-full font-bold",onClick:s[7]||(s[7]=(...t)=>o.exportToExcel&&o.exportToExcel(...t))},[W,m(" Exportar Excel ")])]),e("div",null,[e("input",{type:"file",ref:"fileInput",onChange:s[8]||(s[8]=(...t)=>o.handleFileUpload&&o.handleFileUpload(...t)),class:"hidden"},null,544),e("button",{class:"bg-green-700 text-white px-5 py-1 rounded-md inline-flex items-center w-full font-bold",onClick:s[9]||(s[9]=(...t)=>o.triggerFileInput&&o.triggerFileInput(...t))},[X,m(" Importar Excel ")])])])])]),e("div",Y,[e("table",Z,[$,e("tbody",null,[(r(!0),c(f,null,u(l.filteredMerchants,t=>(r(),c("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[e("td",ee,a(t.name),1),e("td",te,a(t.dni),1),e("td",se,a(t.phone),1),e("td",oe,a(t.location.name),1),e("td",ne,[e("button",{onClick:g=>o.viewDetails(t),class:"bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600 transition"},re,8,le),e("button",{onClick:g=>n.confirmRemove(t),class:"bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600 transition"},de,8,ae)])]))),128))])])]),e("div",he,[(r(!0),c(f,null,u(l.filteredMerchants,t=>(r(),c("div",{key:t.id,class:"bg-white shadow-md rounded-lg p-4"},[e("div",ue,[e("h3",fe,a(t.name)+" - "+a(t.dni),1),e("div",me,[e("button",{onClick:g=>o.viewDetails(t),class:"bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600 transition"},_e,8,ge),e("button",{onClick:g=>n.confirmRemove(t),class:"bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600 transition"},ye,8,xe)])]),e("div",ve,[e("p",null,[we,m(" "+a(t.location.name),1)]),e("p",null,[Me,m(" "+a(t.phone),1)])])]))),128))])]),l.showAddModal?(r(),x(v,{key:0,locations:l.locations,onCloseAddMerchantModal:s[10]||(s[10]=t=>l.showAddModal=!1)},null,8,["locations"])):E("",!0)]),_:1})}const Fe=R(A,[["render",ke]]);export{Fe as default};
