import{L as _}from"./LoaderModal-BlvZehoS.js";import{i as d,j as x,o as a,e as n,a as e,m as S,b as v,k as c,l as h,F as u,h as f,f as m,t as p,p as w,q as M}from"./app-U5YtH81c.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={components:{LoaderModal:_},props:{showModal:{type:Boolean,required:!0}},data(){return{selectedMerchant:null,selectedPOS:null,selectedDate:new Date().toISOString().substr(0,10),today:new Date().toISOString().substr(0,10),merchants:[],pos:[],filteredMerchants:[],filteredPOS:[],merchantSearch:"",posSearch:"",loading:!1}},watch:{showModal(s){s&&this.fetchData()}},methods:{closeModal(){this.$emit("close")},async saveAndAssignAnother(){const s={merchant_id:this.selectedMerchant,pos_id:this.selectedPOS,date:this.selectedDate};try{await d.post("/admin/assignMerchantVisitManual",s),this.resetForm()}catch(t){console.error("Error saving visit:",t)}},async handleSubmit(){const s={merchant_id:this.selectedMerchant,pos_id:this.selectedPOS,date:this.selectedDate};try{await d.post("/admin/assignMerchantVisitManual",s),this.$emit("save",s),this.closeModal()}catch(t){console.error("Error saving visit:",t)}},async fetchData(){this.loading=!0;try{const[s,t]=await Promise.all([d.get("/admin/merchants/all"),d.get("/admin/pointOfSales/all")]);this.merchants=s.data,this.pos=t.data,this.filteredMerchants=this.merchants,this.filteredPOS=this.pos}catch(s){console.error("Error fetching data:",s)}finally{this.loading=!1}},filterMerchants(){const s=this.merchantSearch.toLowerCase();this.filteredMerchants=this.merchants.filter(t=>t.name.toLowerCase().includes(s))},filterPOS(){const s=this.posSearch.toLowerCase();this.filteredPOS=this.pos.filter(t=>t.name.toLowerCase().includes(s))},selectMerchant(s){this.selectedMerchant=s.id,this.merchantSearch=s.name,this.filteredMerchants=[]},selectPOS(s){this.selectedPOS=s.id,this.posSearch=s.name,this.filteredPOS=[]},resetForm(){this.selectedMerchant=null,this.selectedPOS=null,this.selectedDate=new Date().toISOString().substr(0,10),this.merchantSearch="",this.posSearch=""}}},l=s=>(w("data-v-7f71850d"),s=s(),M(),s),P={key:0,class:"fixed z-10 inset-0 overflow-y-auto"},D={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},C=l(()=>e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),V=l(()=>e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),A={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},L={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},I={class:"sm:flex sm:items-start"},B={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},j=l(()=>e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Añadir Visita Manual ",-1)),E={class:"mt-2"},F={key:0,class:"flex justify-center mb-4"},z={key:1},N={class:"mb-4"},U=l(()=>e("label",{for:"merchant",class:"block text-sm font-medium text-gray-700"},"Buscar Mercaderista",-1)),q={class:"relative"},G={key:0,class:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg"},R=["onClick"],T={class:"mb-4"},H=l(()=>e("label",{for:"pos",class:"block text-sm font-medium text-gray-700"},"Buscar Punto de Venta",-1)),J={class:"relative"},K={key:0,class:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg"},Q=["onClick"],W={class:"mb-4"},X=l(()=>e("label",{for:"date",class:"block text-sm font-medium text-gray-700"},"Elige una fecha",-1)),Y=["min"],Z={class:"flex justify-end space-x-2"},$=l(()=>e("button",{type:"submit",class:"bg-green-500 text-white px-4 py-2 rounded-md"},"Guardar y cerrar",-1)),ee={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"};function te(s,t,g,se,r,i){const b=x("LoaderModal");return g.showModal?(a(),n("div",P,[e("div",D,[C,V,e("div",A,[e("div",L,[e("div",I,[e("div",B,[j,e("div",E,[e("form",{onSubmit:t[6]||(t[6]=S((...o)=>i.handleSubmit&&i.handleSubmit(...o),["prevent"]))},[r.loading?(a(),n("div",F,[v(b)])):(a(),n("div",z,[e("div",N,[U,e("div",q,[c(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>r.merchantSearch=o),onInput:t[1]||(t[1]=(...o)=>i.filterMerchants&&i.filterMerchants(...o)),placeholder:"Seleccionar Mercaderista",class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},null,544),[[h,r.merchantSearch]]),r.merchantSearch&&r.filteredMerchants.length?(a(),n("ul",G,[(a(!0),n(u,null,f(r.filteredMerchants,o=>(a(),n("li",{key:o.id,onClick:y=>i.selectMerchant(o),class:"cursor-pointer px-4 py-2 hover:bg-gray-100"},p(o.name),9,R))),128))])):m("",!0)])]),e("div",T,[H,e("div",J,[c(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=o=>r.posSearch=o),onInput:t[3]||(t[3]=(...o)=>i.filterPOS&&i.filterPOS(...o)),placeholder:"Seleccionar Punto de Venta",class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},null,544),[[h,r.posSearch]]),r.posSearch&&r.filteredPOS.length?(a(),n("ul",K,[(a(!0),n(u,null,f(r.filteredPOS,o=>(a(),n("li",{key:o.id,onClick:y=>i.selectPOS(o),class:"cursor-pointer px-4 py-2 hover:bg-gray-100"},p(o.name),9,Q))),128))])):m("",!0)])]),e("div",W,[X,c(e("input",{type:"date",id:"date","onUpdate:modelValue":t[4]||(t[4]=o=>r.selectedDate=o),min:r.today,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},null,8,Y),[[h,r.selectedDate]])]),e("div",Z,[e("button",{type:"button",onClick:t[5]||(t[5]=(...o)=>i.saveAndAssignAnother&&i.saveAndAssignAnother(...o)),class:"bg-blue-500 text-white px-4 py-2 rounded-md"},"Guardar y asignar otra visita"),$])]))],32)])])])]),e("div",ee,[e("button",{onClick:t[7]||(t[7]=(...o)=>i.closeModal&&i.closeModal(...o)),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cerrar ")])])])])):m("",!0)}const ae=k(O,[["render",te],["__scopeId","data-v-7f71850d"]]);export{ae as default};
