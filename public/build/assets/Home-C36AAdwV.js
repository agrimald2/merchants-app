import{_ as f}from"./AdminLayout-PtFUZn3f.js";import{o as i,c as n,w as l,i as r,a as e,t as u,e as d,h as c,F as g,b as x,f as _}from"./app-BHIhVOyI.js";import m from"./PendingVisitsComponent-BaNayFhS.js";import h from"./DoneVisitsComponent-CDD9cv-W.js";import p from"./ScanQR-By76_HLU.js";import"./ResponsiveNavLink-Dp1mmoJj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VisitDetailsModal-P--LvL-T.js";const v={class:"font-semibold text-lg text-white leading-tight text-center"},b={class:"max-w-2xl mx-auto"},V=e("div",{class:"bg-white p-4"},[e("div",{class:"filters"},[e("div",{class:"grid grid-cols-3 gap-4 mb-4"},[e("div",{class:"bg-red-500 text-white rounded-lg p-4 flex flex-col items-center"},[e("div",{class:"text-2xl font-bold"},"10"),e("div",{class:"text-sm"},"Objetivo")]),e("div",{class:"bg-green-500 text-white rounded-lg p-4 flex flex-col items-center"},[e("div",{class:"text-2xl font-bold"},"5"),e("div",{class:"text-sm"},"Realizadas")]),e("div",{class:"bg-yellow-500 text-white rounded-lg p-4 flex flex-col items-center"},[e("div",{class:"text-2xl font-bold"},"5"),e("div",{class:"text-sm"},"Pendientes")])])])],-1),w={class:"px-3 pt-6"},y=e("p",null,"Visitas Pendientes",-1),P={class:"px-3 pt-6"},M=e("p",null,"Visitas Realizadas",-1),Q=e("i",{class:"fa-solid fa-qrcode"},null,-1),C=[Q],R={components:{DoneVisitsComponent:h,PendingVisitsComponent:m,ScanQR:p},data(){return{isQRModalVisible:!1,pendingVisits:[],isOnVisit:!1}},created(){this.fetchPendingVisits(),this.fetchIsOnVisit()},methods:{toggleQrModal(){console.log("Hola 2"),this.isQRModalVisible=!this.isQRModalVisible},async fetchPendingVisits(){try{const t=await r.get(route("merchant.pendingVisits"));this.pendingVisits=t.data}catch(t){console.error("Error fetching pending visits:",t)}},async fetchIsOnVisit(){try{const t=await r.post(route("merchant.isOnVisit"));console.log(t.data)}catch(t){console.error("Error fetching is on visit:",t)}},requestLocationPermission(){navigator.geolocation?navigator.geolocation.getCurrentPosition(()=>{this.toggleQrModal()},t=>{t.code===t.PERMISSION_DENIED&&alert("Location permission is required to start a visit. Please enable location services.")}):alert("Geolocation is not supported by this browser.")}}},N=Object.assign(R,{__name:"Home",setup(t){return(s,a)=>(i(),n(f,{title:"Dashboard"},{header:l(()=>[e("h2",v,u(new Date().toLocaleDateString("es-ES",{weekday:"long",month:"long",day:"numeric"})),1)]),default:l(()=>[e("div",b,[V,e("div",w,[y,(i(!0),d(g,null,c(s.pendingVisits,o=>(i(),n(m,{visit:o,onScan:s.toggleQrModal},null,8,["visit","onScan"]))),256))]),e("div",P,[M,(i(),d(g,null,c(3,o=>x(h)),64))]),e("button",{onClick:a[0]||(a[0]=(...o)=>s.requestLocationPermission&&s.requestLocationPermission(...o)),class:"fixed bottom-4 right-4 bg-red-500 text-white p-4 rounded-full shadow-lg flex items-center justify-center"},C)]),s.isQRModalVisible?(i(),n(p,{key:0,onClose:s.toggleQrModal},null,8,["onClose"])):_("",!0)]),_:1}))}});export{N as default};
