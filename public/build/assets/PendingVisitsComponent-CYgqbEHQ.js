import{i as f,j as _,o as n,e as u,a as o,t as d,g as m,c as g,f as h}from"./app-_BQdblzI.js";import v from"./AddressModal-Dp2JCB3h.js";import{_ as p}from"./_plugin-vue_export-helper-DlAUqK2U.js";const x={components:{AddressModal:v},props:["visit"],data(){return{isModalVisible:!1}},mounted(){},methods:{toggleQRModal(){this.$emit("scan")},startVisit(){console.log(this.visit.id),navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{const{latitude:t,longitude:s}=e.coords;try{const i=await f.post(route("merchant.startVisit"),{code:this.visit.point_of_sale.code,start_latitude:t,start_longitude:s});console.log("Visit started:",i.data),window.location.href=route("merchant.view.visit",{id:i.data.id}),this.closeModal()}catch(i){console.error("Error starting visit:",i),this.errorText=`Error Code 1: ${i.message}`}},e=>{e.code===e.PERMISSION_DENIED&&alert("Activa los permisos de ubicaciÃ³n para realizar una visita."),this.errorText=`Error Code 2: ${e.message}`}):(console.error("Geolocation is not supported by this browser."),this.errorText="Not supported by this browser")},showAddressModal(e){this.isModalVisible=!0,this.$nextTick(()=>{this.$refs[`addressModal-${e}`].openModal()})},closeModal(e){this.$refs[`addressModal-${e}`].closeModal(),this.isModalVisible=!1}}},b={class:"bg-white pt-2 pb-2 px-3 rounded-lg shadow-md flex items-center justify-between space-x-4 my-3 border border-red-500"},M={class:"flex flex-col justify-between"},V={class:"flex items-center space-x-2"},w=o("i",{class:"fa-solid fa-user"},null,-1),y={class:"font-bold text-gray-900"},C={class:"text-right border-l border-gray-200 pl-2"},k=o("i",{class:"fa-solid fa-qrcode mr-2"},null,-1);function E(e,t,s,i,l,a){const c=_("AddressModal");return n(),u("div",b,[o("div",M,[o("div",V,[w,o("div",y,d(s.visit.point_of_sale.code)+" - "+d(s.visit.point_of_sale.name),1)]),o("div",{class:"text-gray-600 text-sm mt-2 cursor-pointer",onClick:t[0]||(t[0]=r=>a.showAddressModal(s.visit.id))},d(s.visit.point_of_sale.address),1)]),o("div",C,[o("button",{class:"bg-red-ac text-white px-5 py-1 rounded-md inline-flex items-center font-bold",onClick:t[1]||(t[1]=(...r)=>a.startVisit&&a.startVisit(...r))},[k,m(" Visitar ")])]),l.isModalVisible?(n(),g(c,{key:0,ref:`addressModal-${s.visit.id}`,latitude:s.visit.point_of_sale.latitude,address:s.visit.point_of_sale.address,longitude:s.visit.point_of_sale.longitude,onClose:t[2]||(t[2]=r=>l.isModalVisible=!1)},null,8,["latitude","address","longitude"])):h("",!0)])}const B=p(x,[["render",E]]);export{B as default};
